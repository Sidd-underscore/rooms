"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.checkForPermissions = void 0;
const discord_js_1 = require("discord.js");
const builders_1 = require("@discordjs/builders");
function checkForPermissions(message, name, iconURL) {
    const { channel } = message;
    // usually a channel is always included, if it isn't, it's most likely due to missing partials like in dm channels
    if (!channel) {
        throw new TypeError('Missing a channel, did you forget to include partials?');
    }
    // if it's not a dm channel, check for sufficient permissions
    if (channel instanceof discord_js_1.TextChannel ||
        channel instanceof discord_js_1.NewsChannel ||
        channel instanceof discord_js_1.ThreadChannel) {
        const perms = channel.permissionsFor(message.guild?.me ?? '');
        if (!perms?.has('ADD_REACTIONS')) {
            const embed = new discord_js_1.MessageEmbed()
                .setColor('DARK_RED')
                .setAuthor({ name, iconURL })
                .setTitle('Missing Permissions')
                .setDescription(`‚ùå I am missing the ${(0, builders_1.inlineCode)('Add Reactions')} permission, please give it to me before using this command`)
                .setTimestamp();
            message.reply({ embeds: [embed] });
            return;
        }
        if (!perms?.has('SEND_MESSAGES')) {
            return;
        }
    }
}
exports.checkForPermissions = checkForPermissions;
